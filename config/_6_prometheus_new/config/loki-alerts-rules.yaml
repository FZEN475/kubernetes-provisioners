groups:
  - name: logs-error-warn-alerts
    rules:
      # ÐŸÑ€Ð°Ð²Ð¸Ð»Ð¾ 1: ÐÐ»ÐµÑ€Ñ‚ Ð¿Ñ€Ð¸ >10 Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ… Ð·Ð° 5 Ð¼Ð¸Ð½ÑƒÑ‚
      - alert: HighErrorRate
        expr: |
          count_over_time(
            {job=~".+"}  |= "error" [5m]
          ) > 1
        for: 1m  # Ð”ÐµÑ€Ð¶Ð°Ñ‚ÑŒÑÑ 1 Ð¼Ð¸Ð½ÑƒÑ‚Ñƒ Ð¿ÐµÑ€ÐµÐ´ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¾Ð¹
        labels:
          severity: "critical"
          namespace: "monitoring"  # Ð§Ñ‚Ð¾Ð±Ñ‹ Alertmanager Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð» Ð² Telegram
        annotations:
          summary: "High ERROR log rate ({{ $value }} lines in 5m)"
          description: |
            ðŸš¨ More than 10 ERROR logs in 5 minutes.
            **Job:** {{ $labels.job }}
            **Namespace:** {{ $labels.namespace | default "unknown" }}

      # ÐŸÑ€Ð°Ð²Ð¸Ð»Ð¾ 2: ÐÐ»ÐµÑ€Ñ‚ Ð¿Ñ€Ð¸ >30 Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸ÑÑ… Ð·Ð° 5 Ð¼Ð¸Ð½ÑƒÑ‚
      - alert: HighWarnRate
        expr: |
          count_over_time(
            {job=~".+"} |= "warn" [5m]
          ) > 1
        for: 1m
        labels:
          severity: "warning"
          namespace: "monitoring"
        annotations:
          summary: "High WARN log rate ({{ $value }} lines in 5m)"
          description: |
            âš  More than 30 WARN logs in 5 minutes.
            **Job:** {{ $labels.job }}
            **Namespace:** {{ $labels.namespace | default "unknown" }}